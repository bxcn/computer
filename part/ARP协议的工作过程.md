#### ARP协议的工作过程： 
当主机A要向主机B发送IP地址时，首先需要判断主机B是否和自己在同一子网中，
- 如果在，则可使用本物理网络直接将IP分组发送给主机B，否则需要通过网关进行转发。因此，主机A在发送前会查询ARP表，以获得主机B或者网关的物理地址（MAC地址）.
- 若找到IP地址对应的MAC地址，则将该MAC地址作为目的MAC地址对IP分组进行帧封装。
- 若在ARP表中找不到相应的IP地址，ARP协议则使用广播地址，发送一个ARP请求报文给子网中的每台主机，每台主机的以太网接口收到这个广播的ARP报文后，
- 若发现请求报文携带的IP地址与自己的IP地址相同，则将自己的物理地址填入ARP响应报文中，并传送给请求主机。请求主机则将返回的MAC地址作为目的MAC地址对IP分组进行帧封装，同时将收到的IP地址和物理地址加入ARP表中。
- 若没有收到响应，则表示目的主机不存在，本地IP进程将放弃发送这个IP 分组。


ARP的请求报文和ARP响应报文使用相同格式
![image](https://upload-images.jianshu.io/upload_images/5177180-abb1f680fc3d3d67?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
