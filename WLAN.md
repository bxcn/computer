广域网基本概念
当主机之间的距离较远时，例如，相隔几十或几百公里，甚至几千公里，局域网显然就无法完成主机之间的通信任务。这里就需要另一种结构的网络，即广域网



广域网与互联网区别
互联网尽管覆盖范围很广，但它不是广域网，它是由多个不同网络构成的，“互联”是其最主要的特征。
广域网是单个网络，它使用结点交换机连接各主机而不是是路由器连接各网络。
结点交换机在单个网络中转发分组，而路由器在多个网络构成的互联网中转发分组。
连接在一个广域网（或一个局域网）上的主机在该网内进行通信时，只需要使用其网络的物理地址即可。

网络层提供的服务
服务与通信子网无关
应该提供面向连接的服务还是无连接服务
   面向连接服务（虚电路服务）：传统电信的观点，通信子网应该提供可靠的、面向连接的服务，而将复杂的功能放在网络层（通信子网）。
  无连接服务（数据报服务）：Internet的观点，通信子网无论怎么设计均不可靠，网络层只需提供无连接服务，而将复杂的功能放在传输层。
  二者本质区别：复杂的差错控制和流量控制放在何处（网络层/传输层）的总是。



数据报服务示意图

数据报服务特点
随时接受主机发送的分组（即数据报）
为每个分组独立地选择路由
尽最大努力地将分组交付给目的主机
对源主机没有任何承诺
不能保证所传送的分组不丢失
不能保证按源主机发送分组的先后顺序以及在时限内必须将分组交付给目的主机
当网络发生拥塞时，结点可根据情况丢弃分组
数据报服务实际上是一种“尽力而为”（Best Effort)的服务


虚电脑示意图







### 数据报服务和虚电路服务对比 
|对比内容|虚电路服务|数据服服务|
|--|--|--|--|
|思路 |可靠通信应当由网络来保证| 可靠通信应当由用户主机来保证|
|连接建立 |必须有 |不要|
|目的站地址 |仅在连接建立阶段使用，每个分组使用短的虚电路号 |每个分组都有目的站的全地址|
|分组的转发 |属于同一条虚电路的分组均按照同一路由进行转发| 每个分组独立选择路由进行转发|
|当结点出故障时| 所有通过出故障的结点的虚电路均不能工作 |故障结点可能丢失分组，一些路由可能会发生变化|
|分组的顺序 |总是按发送顺序到达目的站 |到达目的站时不一定按发送顺序|
|端到端的差错处理和流量控制 |可以由分组交换网负责也可以 |由用户主机负责 由用户主机负责|


### 路由算法
- 路由算法是网络层软件的一部分
  - 子网提供数据报服务，每个包都要做路由选择
  - 子网提供虚电路服务，只需要建立连接时做一次路由选择

- 路由算法应具有的特性
  - 正确性(correctness)
  - 简单性(simplicity)
  - 健壮性(robustness:鲁棒性,网络出现有意外事件的时候，路由算法能不能适应)
  - 稳定性(stability，网络正常使用的时候，第一天还正常，和二天出了一点小总是，半个月后几乎不能正常转发数据了。比如转发几个分组时正常，当转发几百个分组时就出问题了)
  - 公平性(fairness)
  - 最优性(optimality)

### 路由算法分类
- 按转发方式和数据副本数量划分
  - 全路由算法：如洪泛，按照所有路径广播转发
  - 多路路由算法：如选择洪泛算法，向所有接近目的节点的路径转发
  - 单路路由算法：如距离 矢量算法，向目的节点沿着唯一的路转发



### 注意事项
- 一个个网络，也叫网段
- 纯粹几个局域网相连构成的网也叫互联网，互联网相连的网络不一定就是广域网
- 路由器不是直接接主机的，你说路由器不是也是外接，也有一些物理接口吗？也有以太口，甚至还有串口啊 。那么路由器的确 提供了这个外设接口。你说广域网的节点交换机甚至我们的主机不也提供有类似这些物理接口吗。但是路由器这些物理接口用于连接 的都是我们有时都叫网段但首先这个网的段的概念和小型的网络是一回事的。路由器连接的都是一个个网络。
- 局域网和广域网的内部通信都需要物理地址，比如局域网通信用MAC地址，广域网通信使用ATM网络ATM地址。
- 以太网主机能不能和ATM主机直接通信？ 以太网主机知道ATM主机的ATM地址。这个绝对通不起来。 跨网传输必须作用路由器或者说使用网间连接设备。
- 在网络层提供的面向连接服务叫虚电路服务，网络层提供的无连接服务叫数据报服务
- 面向连接服务和无连接服务没有层次关系。
- 面向连接服务可控制性强，比较容易实现差错控制和流量控制。
- 路由算法特性能不能同时出现，一些特性是相互矛盾的，如果路由算法简单性的，对健壮性和稳定性就不能保证了，所以最后就一个全局的总体和最优性，只能是一个折中各个指标的一个权衡最终的一个比较优化的指标
- 按转发方式和数据副本数量划分：首先针对的都是一个单播通信当中，就是源端的数据明确地发给一个特定的目的方，是这种情况下的路由过程。
- 在通信过程中，通信双方以分组为单位、使用存储-转发机制实现数据交互的通信方式，**被称为分组交换（PS:packet switching）**